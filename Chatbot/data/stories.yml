version: "3.1"

stories:
- story: direct city selection path
  steps:
  - intent: request_trip
  - action: trip_form
  - active_loop: trip_form
  - intent: share_state
    entities:
    - state: "Luxor"
  - slot_was_set:
    - state: "Luxor"
    - specify_place: true
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: budget
  - intent: share_budget
    entities:
    - budget: "500"
  - slot_was_set:
    - budget: 500
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: duration
  - intent: share_duration
    entities:
    - duration: "3 days"
  - slot_was_set:
    - duration: 3
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: arrival_date
  - intent: share_arrival_date
    entities:
    - arrival_date: "next week"
  - slot_was_set:
    - arrival_date: ["2024-03-25", "2024-03-31"]
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: hotel_features
  - intent: share_hotel_features
    entities:
    - hotel_features: "pool and wifi"
  - slot_was_set:
    - hotel_features: ["pool", "wifi"]
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: landmarks_activities
  - intent: share_landmarks_activities
    entities:
    - landmarks_activities: "temples and museums"
  - slot_was_set:
    - landmarks_activities: ["temples", "museums"]
  - action: trip_form
  - active_loop: null
  - slot_was_set:
    - requested_slot: null
  - action: utter_start_suggestions
  - action: action_suggest_plan
  - action: utter_edit_preference_or_suggest_trip
  - action: action_listen

- story: city description path
  steps:
  - intent: request_trip
  - action: trip_form
  - active_loop: trip_form
  - intent: deny
  - slot_was_set:
    - specify_place: false
  - action: trip_form
  - slot_was_set:
    - requested_slot: city_description
  - intent: describe_city
    entities:
    - city_description: "historical city with ancient temples"
  - slot_was_set:
    - city_description: "historical city with ancient temples"
    - suggested_cities: ["Luxor", "Aswan", "Cairo"]
    - awaiting_city_selection: true
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: selected_city
  - intent: share_state
    entities:
    - state: "Luxor"
  - slot_was_set:
    - state: "Luxor"
    - selected_city: "Luxor"
    - awaiting_city_selection: false
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: budget
  - intent: share_budget
    entities:
    - budget: "500"
  - slot_was_set:
    - budget: 500
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: duration
  - intent: share_duration
    entities:
    - duration: "3 days"
  - slot_was_set:
    - duration: 3
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: arrival_date
  - intent: share_arrival_date
    entities:
    - arrival_date: "next week"
  - slot_was_set:
    - arrival_date: ["2024-03-25", "2024-03-31"]
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: hotel_features
  - intent: share_hotel_features
    entities:
    - hotel_features: "pool and wifi"
  - slot_was_set:
    - hotel_features: ["pool", "wifi"]
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: landmarks_activities
  - intent: share_landmarks_activities
    entities:
    - landmarks_activities: "temples and museums"
  - slot_was_set:
    - landmarks_activities: ["temples", "museums"]
  - action: trip_form
  - active_loop: null
  - slot_was_set:
    - requested_slot: null
  - action: utter_start_suggestions
  - action: action_suggest_plan
  - action: utter_edit_preference_or_suggest_trip
  - action: action_listen

- story: handle form interruption
  steps:
  - intent: request_trip
  - action: trip_form
  - active_loop: trip_form
  - intent: bot_challenge
  - action: utter_iamabot
  - action: trip_form
  - active_loop: trip_form
  - intent: share_state
    entities:
    - state: "Luxor"
  - slot_was_set:
    - state: "Luxor"
    - specify_place: true
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: budget
  - intent: share_budget
    entities:
    - budget: "500"
  - slot_was_set:
    - budget: 500
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: duration
  - intent: share_duration
    entities:
    - duration: "3 days"
  - slot_was_set:
    - duration: 3
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: arrival_date
  - intent: share_arrival_date
    entities:
    - arrival_date: "next week"
  - slot_was_set:
    - arrival_date: ["2024-03-25", "2024-03-31"]
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: hotel_features
  - intent: share_hotel_features
    entities:
    - hotel_features: "pool and wifi"
  - slot_was_set:
    - hotel_features: ["pool", "wifi"]
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: landmarks_activities
  - intent: share_landmarks_activities
    entities:
    - landmarks_activities: "temples and museums"
  - slot_was_set:
    - landmarks_activities: ["temples", "museums"]
  - action: trip_form
  - active_loop: null
  - slot_was_set:
    - requested_slot: null
  - action: utter_start_suggestions
  - action: action_suggest_plan
  - action: utter_edit_preference_or_suggest_trip
  - action: action_listen

- story: handle out of scope during form
  steps:
  - intent: request_trip
  - action: trip_form
  - active_loop: trip_form
  - intent: out_of_scope
  - action: utter_out_of_scope
  - action: trip_form
  - active_loop: trip_form
  - intent: share_state
    entities:
    - state: "Luxor"
  - slot_was_set:
    - state: "Luxor"
    - specify_place: true
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: budget
  - intent: share_budget
    entities:
    - budget: "500"
  - slot_was_set:
    - budget: 500
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: duration
  - intent: share_duration
    entities:
    - duration: "3 days"
  - slot_was_set:
    - duration: 3
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: arrival_date
  - intent: share_arrival_date
    entities:
    - arrival_date: "next week"
  - slot_was_set:
    - arrival_date: ["2024-03-25", "2024-03-31"]
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: hotel_features
  - intent: share_hotel_features
    entities:
    - hotel_features: "pool and wifi"
  - slot_was_set:
    - hotel_features: ["pool", "wifi"]
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: landmarks_activities
  - intent: share_landmarks_activities
    entities:
    - landmarks_activities: "temples and museums"
  - slot_was_set:
    - landmarks_activities: ["temples", "museums"]
  - action: trip_form
  - active_loop: null
  - slot_was_set:
    - requested_slot: null
  - action: utter_start_suggestions
  - action: action_suggest_plan
  - action: utter_edit_preference_or_suggest_trip
  - action: action_listen

- story: multiple entities in first message
  steps:
  - intent: request_trip
    entities:
    - state: "Luxor"
    - budget: "1500$"
    - duration: "3 days"
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - state: "Luxor"
    - specify_place: true
    - budget: 1500
    - duration: 3
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: arrival_date
  - intent: share_arrival_date
    entities:
    - arrival_date: "next week"
  - slot_was_set:
    - arrival_date: ["2024-03-25", "2024-03-31"]
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: hotel_features
  - intent: share_hotel_features
    entities:
    - hotel_features: "pool and wifi"
  - slot_was_set:
    - hotel_features: ["pool", "wifi"]
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: landmarks_activities
  - intent: share_landmarks_activities
    entities:
    - landmarks_activities: "temples and museums"
  - slot_was_set:
    - landmarks_activities: ["temples", "museums"]
  - action: trip_form
  - active_loop: null
  - slot_was_set:
    - requested_slot: null
  - action: utter_start_suggestions
  - action: action_suggest_plan
  - action: utter_edit_preference_or_suggest_trip
  - action: action_listen

- story: multiple entities in middle of form
  steps:
  - intent: request_trip
  - action: trip_form
  - active_loop: trip_form
  - intent: share_state
    entities:
    - state: "Luxor"
  - slot_was_set:
    - state: "Luxor"
    - specify_place: true
  - action: trip_form
  - slot_was_set:
    - requested_slot: budget
  - intent: share_budget
    entities:
    - budget: "500 dollars"
    - duration: "5 days"
  - slot_was_set:
    - budget: 500
    - duration: 5
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: arrival_date
  - intent: share_arrival_date
    entities:
    - arrival_date: "next week"
  - slot_was_set:
    - arrival_date: ["2024-03-25", "2024-03-31"]
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: hotel_features
  - intent: share_hotel_features
    entities:
    - hotel_features: "pool and wifi"
  - slot_was_set:
    - hotel_features: ["pool", "wifi"]
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: landmarks_activities
  - intent: share_landmarks_activities
    entities:
    - landmarks_activities: "temples and museums"
  - slot_was_set:
    - landmarks_activities: ["temples", "museums"]
  - action: trip_form
  - active_loop: null
  - slot_was_set:
    - requested_slot: null
  - action: utter_start_suggestions
  - action: action_suggest_plan
  - action: utter_edit_preference_or_suggest_trip
  - action: action_listen

- story: out of order information
  steps:
  - intent: request_trip
  - action: trip_form
  - active_loop: trip_form
  - intent: share_budget
    entities:
    - budget: "$500"
  - slot_was_set:
    - budget: 500
  - action: trip_form
  - slot_was_set:
    - requested_slot: state
  - intent: share_state
    entities:
    - state: "Luxor"
  - slot_was_set:
    - state: "Luxor"
    - specify_place: true
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: duration
  - intent: share_duration
    entities:
    - duration: "3 days"
  - slot_was_set:
    - duration: 3
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: arrival_date
  - intent: share_arrival_date
    entities:
    - arrival_date: "next week"
  - slot_was_set:
    - arrival_date: ["2024-03-25", "2024-03-31"]
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: hotel_features
  - intent: share_hotel_features
    entities:
    - hotel_features: "pool and wifi"
  - slot_was_set:
    - hotel_features: ["pool", "wifi"]
  - action: trip_form
  - active_loop: trip_form
  - slot_was_set:
    - requested_slot: landmarks_activities
  - intent: share_landmarks_activities
    entities:
    - landmarks_activities: "temples and museums"
  - slot_was_set:
    - landmarks_activities: ["temples", "museums"]
  - action: trip_form
  - active_loop: null
  - slot_was_set:
    - requested_slot: null
  - action: utter_start_suggestions
  - action: action_suggest_plan
  - action: utter_edit_preference_or_suggest_trip
  - action: action_listen
